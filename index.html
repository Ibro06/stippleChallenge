<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.21">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Blue Noise Stippling: Creating Art from Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="index_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="index_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-ea1d7ac60288e0f1efdbc993fd8432ae.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Blue Noise Stippling: Creating Art from Data</h1>
<p class="subtitle lead">Transforming Photographs into Aesthetic Dot Patterns</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="blue-noise-stippling-transforming-photographs-into-art" class="level1">
<h1>Blue Noise Stippling: Transforming Photographs into Art</h1>
<section id="the-problem-can-algorithms-create-art" class="level2">
<h2 class="anchored" data-anchor-id="the-problem-can-algorithms-create-art">The Problem: Can Algorithms Create Art?</h2>
<p><strong>Core Question:</strong> How can we convert a photograph into an aesthetically pleasing pattern of dots that preserves the visual information of the original image?</p>
<p><strong>The Challenge:</strong> Blue noise stippling is a technique that converts images into patterns of dots (stipples) using algorithms that balance visual accuracy with spatial distribution. This implementation uses a modified “void and cluster” algorithm that combines importance sampling with blue noise distribution properties to create stippling patterns that are both visually accurate and spatially well-distributed.</p>
<p><strong>Our Approach:</strong> We use a modified void-and-cluster algorithm that: 1. Creates an importance map identifying visually important regions 2. Uses a toroidal (periodic) Gaussian kernel for repulsion to ensure blue noise properties 3. Iteratively selects points with minimum energy 4. Balances image content importance with blue noise spatial distribution</p>
</section>
<section id="introduction-to-blue-noise-stippling" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-blue-noise-stippling">Introduction to Blue Noise Stippling</h2>
<p>Blue noise stippling is a technique for converting images into a pattern of dots (stipples) that preserves the visual information of the original image while creating an aesthetically pleasing, evenly distributed pattern. This method follows the approach described by <a href="https://bartwronski.com/2022/08/31/progressive-image-stippling-and-greedy-blue-noise-importance-sampling/">Bart Wronski</a>.</p>
<p>The method uses a modified “void and cluster” algorithm that combines importance sampling with blue noise distribution properties to create stippling patterns that are both visually accurate and spatially well-distributed. This version uses <strong>smooth extreme downweighting</strong> that selectively downweights very dark and very light tones while preserving mid-tones, creating a more balanced distribution of stipples across the image.</p>
</section>
<section id="loading-the-original-image" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-original-image">Loading the Original Image</h2>
<p>We begin by loading the photograph that will be transformed into a blue noise stippling pattern.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>(np.float64(-0.5), np.float64(767.5), np.float64(1023.5), np.float64(-0.5))</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/load-image-1.png" class="img-fluid figure-img" width="624"></p>
<figcaption>Original image before stippling</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Image shape: (1024, 768)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Image size: 1024x768 pixels</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: magrittr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'imager'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:magrittr':

    add</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    convolve, spectrum</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    frame</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:base':

    save.image</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/load-image-r-3.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Original image before stippling</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Image dimensions: 768 x 1024 pixels</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="importance-mapping" class="level2">
<h2 class="anchored" data-anchor-id="importance-mapping">Importance Mapping</h2>
<p>Before applying the stippling algorithm, we create an <strong>importance map</strong> that identifies which regions of the image should receive more stipples. The importance map is computed by:</p>
<ul>
<li><strong>Brightness inversion</strong>: The image brightness is inverted so that dark areas receive higher importance and thus more dots, while light areas receive fewer dots</li>
<li><strong>Extreme tone downweighting</strong>: Smooth Gaussian functions downweight tones below 0.2 (very dark) and above 0.8 (very light), creating a gradual transition that preserves mid-tones</li>
<li><strong>Mid-tone boost</strong>: A smooth Gaussian function centered on mid-tones provides a gradual increase in importance for mid-tone regions, ensuring they receive appropriate stippling density</li>
<li><strong>Selective and effective</strong>: This approach ensures that stipples are distributed appropriately (more dots in dark areas and mid-tones, fewer in extreme dark/light areas) while maintaining good spatial distribution</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>Key Design Element: Importance Mapping
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>compute_importance</code> function is the primary mechanism for controlling dot distribution in the stippled image. Key parameters include:</p>
<ul>
<li><strong>Tone thresholds</strong>: <code>extreme_threshold_low</code> and <code>extreme_threshold_high</code> define what counts as “extreme” tones</li>
<li><strong>Downweighting strength</strong>: <code>extreme_downweight</code> (0.0-1.0) controls reduction of stipples in very dark or very light areas</li>
<li><strong>Tone emphasis</strong>: <code>mid_tone_boost</code> and <code>mid_tone_center</code> emphasize particular brightness ranges</li>
<li><strong>Transition smoothness</strong>: <code>extreme_sigma</code> and <code>mid_tone_sigma</code> control the sharpness of transitions</li>
</ul>
<p>This function allows fine-tuning of the stippling pattern without modifying the core algorithm.</p>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">

</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">

</div>
</div>
</div>
</section>
<section id="blue-noise-stippling-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="blue-noise-stippling-algorithm">Blue Noise Stippling Algorithm</h2>
<p>The stippling algorithm uses a modified void-and-cluster approach that:</p>
<ol type="1">
<li>Creates an importance map that identifies visually important regions</li>
<li>Initializes an energy field based on the importance map (higher importance → lower energy)</li>
<li>Uses a toroidal (periodic) Gaussian kernel for repulsion to ensure blue noise properties</li>
<li>Iteratively selects points with minimum energy</li>
<li>Adds Gaussian “splats” around selected points to prevent clustering</li>
<li>Balances image content importance with blue noise spatial distribution</li>
</ol>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">

</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">

</div>
</div>
</div>
</section>
<section id="preparing-the-working-image" class="level2">
<h2 class="anchored" data-anchor-id="preparing-the-working-image">Preparing the Working Image</h2>
<p>Before generating the stippling pattern, we prepare the image by resizing if necessary and computing the importance map.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Resized image from (1024, 768) to (512, 384) for processing</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Final image shape: (512, 384) (should be 2D for grayscale)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance map computed</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Resized image to 384 x 512 for processing</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Final image shape: 512 x 384 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance map computed</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="generating-the-stippled-image" class="level2">
<h2 class="anchored" data-anchor-id="generating-the-stippled-image">Generating the Stippled Image</h2>
<p>Now let’s apply the stippling algorithm to create the blue noise stippling pattern.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Generating blue noise stippling pattern...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generated 15728 stipple points</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Stipple pattern shape: (512, 384)</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Generating blue noise stippling pattern...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generated 15728 stipple points</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Stipple pattern shape: 512 x 384 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="displaying-the-results" class="level2">
<h2 class="anchored" data-anchor-id="displaying-the-results">Displaying the Results</h2>
<p>Let’s visualize the original image, the importance map, and the stippled version side by side for comparison.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>(np.float64(-0.5), np.float64(383.5), np.float64(511.5), np.float64(-0.5))</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(np.float64(-0.5), np.float64(383.5), np.float64(511.5), np.float64(-0.5))</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(np.float64(-0.5), np.float64(383.5), np.float64(511.5), np.float64(-0.5))</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/display-results-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Comparison of original image, importance map, and blue noise stippling</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/display-results-r-3.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Comparison of original image, importance map, and blue noise stippling</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="progressive-stippling-animation" class="level2">
<h2 class="anchored" data-anchor-id="progressive-stippling-animation">Progressive Stippling Animation</h2>
<p>This section creates a GIF showing how the stippled image looks as more points are added sequentially. We’ll use the already-computed stippling points to generate frames at increments of 100 points.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Using existing stippling with 15728 points</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Image shape: (512, 384)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generated 159 frames</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Point counts: [1, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 2100, 2200, 2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000, 3100, 3200, 3300, 3400, 3500, 3600, 3700, 3800, 3900, 4000, 4100, 4200, 4300, 4400, 4500, 4600, 4700, 4800, 4900, 5000, 5100, 5200, 5300, 5400, 5500, 5600, 5700, 5800, 5900, 6000, 6100, 6200, 6300, 6400, 6500, 6600, 6700, 6800, 6900, 7000, 7100, 7200, 7300, 7400, 7500, 7600, 7700, 7800, 7900, 8000, 8100, 8200, 8300, 8400, 8500, 8600, 8700, 8800, 8900, 9000, 9100, 9200, 9300, 9400, 9500, 9600, 9700, 9800, 9900, 10000, 10100, 10200, 10300, 10400, 10500, 10600, 10700, 10800, 10900, 11000, 11100, 11200, 11300, 11400, 11500, 11600, 11700, 11800, 11900, 12000, 12100, 12200, 12300, 12400, 12500, 12600, 12700, 12800, 12900, 13000, 13100, 13200, 13300, 13400, 13500, 13600, 13700, 13800, 13900, 14000, 14100, 14200, 14300, 14400, 14500, 14600, 14700, 14800, 14900, 15000, 15100, 15200, 15300, 15400, 15500, 15600, 15700, 15728]</code></pre>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Using existing stippling with 15728 points</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Image shape: 512 x 384 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generated 159 frames</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Point counts: 1, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 2100, 2200, 2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000, 3100, 3200, 3300, 3400, 3500, 3600, 3700, 3800, 3900, 4000, 4100, 4200, 4300, 4400, 4500, 4600, 4700, 4800, 4900, 5000, 5100, 5200, 5300, 5400, 5500, 5600, 5700, 5800, 5900, 6000, 6100, 6200, 6300, 6400, 6500, 6600, 6700, 6800, 6900, 7000, 7100, 7200, 7300, 7400, 7500, 7600, 7700, 7800, 7900, 8000, 8100, 8200, 8300, 8400, 8500, 8600, 8700, 8800, 8900, 9000, 9100, 9200, 9300, 9400, 9500, 9600, 9700, 9800, 9900, 10000, 10100, 10200, 10300, 10400, 10500, 10600, 10700, 10800, 10900, 11000, 11100, 11200, 11300, 11400, 11500, 11600, 11700, 11800, 11900, 12000, 12100, 12200, 12300, 12400, 12500, 12600, 12700, 12800, 12900, 13000, 13100, 13200, 13300, 13400, 13500, 13600, 13700, 13800, 13900, 14000, 14100, 14200, 14300, 14400, 14500, 14600, 14700, 14800, 14900, 15000, 15100, 15200, 15300, 15400, 15500, 15600, 15700, 15728 </code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Now let’s create the GIF animation:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">

</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">

</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="progressive_stippling.gif" class="img-fluid figure-img"></p>
<figcaption>Progressive stippling animation showing the sequential build-up of points. Each frame represents an increment of 100 points, demonstrating how the blue noise stippling pattern develops as more points are added.</figcaption>
</figure>
</div>
</section>
<section id="appendix-average-tone-by-section" class="level2">
<h2 class="anchored" data-anchor-id="appendix-average-tone-by-section">Appendix: Average Tone by Section</h2>
<p>To understand the distribution of tones across the image and identify the center of skin tone, we divide the image into a grid of small sections and compute the average brightness in each section.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>(np.float64(-0.5), np.float64(383.5), np.float64(511.5), np.float64(-0.5))</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;matplotlib.colorbar.Colorbar object at 0x128a872d0&gt;</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/tone-analysis-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>Grid showing average tone in each section</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Grid size: 16 rows × 12 columns</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Section size: approximately 32 × 32 pixels</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Average tone statistics:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Overall mean: 0.308</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Overall std: 0.224</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Min: 0.015</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Max: 0.853</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sections with tone close to skin tone (0.7 ± 0.1):</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Row 9, Col 11: 0.700
  Row 8, Col 3: 0.701
  Row 7, Col 3: 0.689
  Row 5, Col 9: 0.683
  Row 9, Col 3: 0.718
  Row 6, Col 3: 0.679
  Row 6, Col 11: 0.667
  Row 9, Col 4: 0.658
  Row 6, Col 4: 0.751
  Row 6, Col 9: 0.646
  Row 7, Col 4: 0.639
  Row 6, Col 10: 0.769
  Row 5, Col 10: 0.771
  Row 13, Col 11: 0.626
  Row 12, Col 1: 0.621
  Row 9, Col 9: 0.794
  Row 6, Col 5: 0.601</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Full grid of average tones (row, col):</code></pre>
</div>
<pre><code> ::: {.cell-output .cell-output-stdout}</code></pre>
<pre><code>Col 0 Col 1 Col 2 Col 3 Col 4 Col 5 Col 6 Col 7 Col 8 Col 9 Col10 Col11 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Row 0 0.092 0.096 0.023 0.024 0.050 0.025 0.025 0.015 0.018 0.019 0.049 0.093 
Row 1 0.065 0.027 0.022 0.025 0.078 0.021 0.020 0.018 0.020 0.030 0.034 0.044 
Row 2 0.078 0.040 0.030 0.035 0.098 0.027 0.032 0.024 0.023 0.216 0.110 0.107 
Row 3 0.084 0.049 0.033 0.031 0.104 0.035 0.027 0.031 0.032 0.300 0.350 0.242 
Row 4 0.090 0.038 0.035 0.037 0.093 0.047 0.193 0.267 0.139 0.557 0.563 0.536 
Row 5 0.092 0.049 0.125 0.151 0.174 0.189 0.338 0.436 0.211 0.683 0.771 0.544 
Row 6 0.088 0.144 0.393 0.679 0.751 0.601 0.317 0.333 0.494 0.646 0.769 0.667 
Row 7 0.081 0.217 0.376 0.689 0.639 0.354 0.357 0.336 0.539 0.817 0.853 0.472 
Row 8 0.068 0.074 0.345 0.701 0.429 0.356 0.380 0.485 0.506 0.817 0.847 0.430 
Row 9 0.060 0.072 0.330 0.718 0.658 0.470 0.350 0.326 0.423 0.794 0.820 0.700 
Row10 0.171 0.285 0.558 0.583 0.537 0.374 0.335 0.320 0.347 0.518 0.461 0.437 
Row11 0.302 0.463 0.315 0.373 0.464 0.428 0.332 0.306 0.282 0.291 0.256 0.281 
Row12 0.501 0.621 0.374 0.509 0.585 0.560 0.307 0.284 0.258 0.376 0.372 0.420 
Row13 0.417 0.386 0.552 0.493 0.526 0.311 0.269 0.281 0.229 0.442 0.421 0.626 
Row14 0.448 0.476 0.496 0.410 0.235 0.225 0.251 0.252 0.204 0.414 0.487 0.509 
Row15 0.453 0.421 0.334 0.235 0.236 0.212 0.209 0.204 0.188 0.255 0.332 0.319 </code></pre>
</div>
</div>
</div>
</div>
<section id="r-8" class="level3">
<h3 class="anchored" data-anchor-id="r-8">R</h3>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/tone-analysis-r-3.png" class="img-fluid figure-img" width="1152"></p>
<figcaption>Grid showing average tone in each section</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Grid size: 16 rows × 12 columns</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Section size: approximately 32 × 32 pixels</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Average tone statistics:</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Overall mean: 0.324 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Overall std: 0.253 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Min: 0.015 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Max: 0.967 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Sections with tone close to skin tone (0.7 ± 0.1 ):</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>  Row 7 , Col 10 : 0.693 
  Row 8 , Col 4 : 0.693 
  Row 14 , Col 3 : 0.712 
  Row 13 , Col 1 : 0.687 
  Row 13 , Col 5 : 0.687 
  Row 9 , Col 4 : 0.720 
  Row 7 , Col 4 : 0.677 
  Row 11 , Col 4 : 0.676 
  Row 6 , Col 10 : 0.733 
  Row 13 , Col 4 : 0.666 
  Row 11 , Col 5 : 0.666 
  Row 13 , Col 2 : 0.735 
  Row 10 , Col 4 : 0.748 
  Row 7 , Col 5 : 0.749 
  Row 14 , Col 12 : 0.651 
  Row 10 , Col 5 : 0.649 
  Row 14 , Col 4 : 0.647 
  Row 15 , Col 3 : 0.643 
  Row 7 , Col 12 : 0.764 
  Row 8 , Col 5 : 0.632 
  Row 14 , Col 5 : 0.613 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Full grid of average tones (row, col):</code></pre>
</div>
<pre><code> ::: {.cell-output .cell-output-stdout}</code></pre>
<pre><code>Col 1 Col 2 Col 3 Col 4 Col 5 Col 6 Col 7 Col 8 Col 9 Col10 Col11 Col12 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Row 1 0.129 0.125 0.023 0.024 0.049 0.025 0.024 0.015 0.018 0.019 0.046 0.087 
Row 2 0.094 0.039 0.026 0.025 0.078 0.021 0.020 0.018 0.020 0.028 0.034 0.044 
Row 3 0.110 0.050 0.035 0.037 0.103 0.029 0.037 0.023 0.023 0.131 0.080 0.112 
Row 4 0.115 0.049 0.031 0.030 0.104 0.038 0.027 0.029 0.031 0.225 0.224 0.219 
Row 5 0.124 0.046 0.034 0.035 0.090 0.048 0.201 0.305 0.131 0.562 0.565 0.557 
Row 6 0.125 0.062 0.123 0.144 0.160 0.184 0.351 0.521 0.203 0.733 0.832 0.579 
Row 7 0.121 0.183 0.394 0.677 0.749 0.585 0.292 0.332 0.524 0.693 0.851 0.764 
Row 8 0.115 0.274 0.383 0.693 0.632 0.323 0.320 0.310 0.587 0.937 0.967 0.463 
Row 9 0.076 0.080 0.352 0.720 0.403 0.317 0.351 0.555 0.552 0.942 0.964 0.396 
Row10 0.066 0.079 0.341 0.748 0.649 0.445 0.314 0.295 0.438 0.923 0.950 0.823 
Row11 0.162 0.217 0.572 0.676 0.666 0.442 0.297 0.288 0.329 0.531 0.446 0.428 
Row12 0.361 0.500 0.382 0.473 0.583 0.493 0.295 0.274 0.246 0.169 0.144 0.163 
Row13 0.687 0.735 0.468 0.666 0.687 0.550 0.271 0.251 0.228 0.317 0.310 0.351 
Row14 0.493 0.449 0.712 0.647 0.613 0.319 0.235 0.247 0.202 0.445 0.446 0.651 
Row15 0.549 0.588 0.643 0.520 0.260 0.222 0.220 0.222 0.177 0.428 0.528 0.537 
Row16 0.560 0.519 0.407 0.251 0.250 0.211 0.185 0.179 0.180 0.258 0.345 0.332 </code></pre>
</div>
<p>:::</p>
<p>:::</p>
</section>
</section>
<section id="final-results" class="level2">
<h2 class="anchored" data-anchor-id="final-results">Final Results</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">Python</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">R</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>(np.float64(-0.5), np.float64(383.5), np.float64(511.5), np.float64(-0.5))</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>(np.float64(-0.5), np.float64(383.5), np.float64(511.5), np.float64(-0.5))</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/challenge-comparison-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Side-by-side comparison of original and stippled images</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/challenge-comparison-r-3.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Side-by-side comparison of original and stippled images</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>